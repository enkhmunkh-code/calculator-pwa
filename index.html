<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Үнийн тооцоолуур</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    h1 { text-align: center; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; }
    .result { margin-top: 10px; padding: 10px; background: #f1f1f1; border-radius: 5px; }
    .highlight { font-weight: bold; color: darkblue; }
  </style>
</head>
<body>
  <h1>Машин оруулалтын үнийн тооцоолуур</h1>

  <label>1. Дуудлага худалдааны анхны үнэ (JPY):</label>
  <input type="number" id="initialPrice" placeholder="Жишээ: 500000">

  <label>2. Япон улсын татвар (10%)</label>
  <div class="result" id="jpTax">0 ¥</div>

  <label>3. Дотоод зардал (40000¥)</label>
  <div class="result">40,000 ¥</div>

  <label>4. Нийт Япон дахь зардал</label>
  <div class="result" id="jpTotal">0 ¥</div>

  <label>5. JPY → MNT ханш:</label>
  <input type="number" id="jpyRate" placeholder="Жишээ: 25">

  <label>Нийт зардал (MNT)</label>
  <div class="result" id="mntTotal">0 ₮</div>

  <label>6. Тээврийн зардал (1200 USD)</label>
  <input type="number" id="usdRate" placeholder="USD → MNT ханш">
  <div class="result" id="shipping">0 ₮</div>

  <label>7. Машины үйлдвэрлэсэн он:</label>
  <select id="year"></select>

  <label>8. Хөдөлгүүрийн төрөл:</label>
  <select id="engineType">
    <option value="normal">Бензин/Дизель</option>
    <option value="hybrid">Hybrid / Газ</option>
  </select>

  <label>9. Хөдөлгүүрийн багтаамж (cc):</label>
  <input type="number" id="engineCC" placeholder="Жишээ: 1800">

  <label>Онцгой албан татвар:</label>
  <div class="result" id="excise">0 ₮</div>

  <label>8. Гааль + НӨАТ (15.5%)</label>
  <div class="result" id="taxVat">0 ₮</div>

  <h2>Нийт үнэ:</h2>
  <div class="result highlight" id="grandTotal">0 ₮</div>

  <script>
    // онцгой албан татварын хүснэгт
    const exciseTable = {
      normal: [
        { max: 1500, values: [750000, 1600000, 3350000, 10000000] },
        { max: 2500, values: [2300000, 3200000, 5000000, 11700000] },
        { max: 3500, values: [3050000, 4000000, 6700000, 13350000] },
        { max: 4500, values: [6850000, 8000000, 10850000, 17500000] },
        { max: Infinity, values: [14210000, 27200000, 39150000, 65975000] }
      ],
      hybrid: [
        { max: 1500, values: [375000, 800000, 1675000, 5000000] },
        { max: 2500, values: [1150000, 1600000, 2500000, 5850000] },
        { max: 3500, values: [1525000, 2000000, 3350000, 6675000] },
        { max: 4500, values: [3425375, 4000000, 5425000, 8750000] },
        { max: Infinity, values: [7105000, 13600000, 19575000, 32987500] }
      ]
    };

    function formatNumber(num) {
      return num.toLocaleString("mn-MN");
    }

    function calculate() {
      const initialPrice = Number(document.getElementById("initialPrice").value) || 0;
      const jpyRate = Number(document.getElementById("jpyRate").value) || 0;
      const usdRate = Number(document.getElementById("usdRate").value) || 0;
      const year = Number(document.getElementById("year").value);
      const engineType = document.getElementById("engineType").value;
      const engineCC = Number(document.getElementById("engineCC").value) || 0;

      // 2. Япон татвар
      const jpTax = initialPrice * 0.1;
      document.getElementById("jpTax").innerText = formatNumber(jpTax) + " ¥";

      // 4. Япон дахь нийт
      const jpTotal = initialPrice + jpTax + 40000;
      document.getElementById("jpTotal").innerText = formatNumber(jpTotal) + " ¥";

      // 5. MNT-д хөрвүүлэх
      const mntTotal = jpTotal * jpyRate;
      document.getElementById("mntTotal").innerText = formatNumber(mntTotal) + " ₮";

      // 6. Тээвэр
      const shipping = 1200 * usdRate;
      document.getElementById("shipping").innerText = formatNumber(shipping) + " ₮";

      // 7-9. Онцгой албан татвар
      let excise = 0;
      if (year > 0 && engineCC > 0) {
        const currentYear = new Date().getFullYear();
        const age = currentYear - year;
        let col = 0;
        if (age <= 3) col = 0;
        else if (age <= 6) col = 1;
        else if (age <= 9) col = 2;
        else col = 3;

        const table = exciseTable[engineType];
        for (let row of table) {
          if (engineCC <= row.max) {
            excise = row.values[col];
            break;
          }
        }
      }
      document.getElementById("excise").innerText = formatNumber(excise) + " ₮";

      // 8. Гааль + НӨАТ
      const taxVat = (mntTotal + shipping + excise) * 0.155;
      document.getElementById("taxVat").innerText = formatNumber(taxVat) + " ₮";

      // 9. Нийт үнэ
      const grandTotal = mntTotal + shipping + excise + taxVat;
      document.getElementById("grandTotal").innerText = formatNumber(grandTotal) + " ₮";
    }

    document.querySelectorAll("input, select").forEach(el => {
      el.addEventListener("input", calculate);
      el.addEventListener("change", calculate);
    });

    // Машины он сонгох хэсэг
    const yearSelect = document.getElementById("year");
    const currentYear = new Date().getFullYear();
    for (let y = currentYear; y >= 2000; y--) {
      const opt = document.createElement("option");
      opt.value = y;
      opt.innerText = y;
      yearSelect.appendChild(opt);
    }
  </script>
</body>
</html>
